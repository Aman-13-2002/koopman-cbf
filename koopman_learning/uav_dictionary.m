
x = sym('x',[17,1],'real');
x1 = x(1);
x2 = x(2);
x3 = x(3);
x4 = x(4);
x5 = x(5);
x6 = x(6);
x7 = x(7);
x8 = x(8);
x9 = x(9);
x10 = x(10);
x11 = x(11);
x12 = x(12);
x13 = x(13);
x14 = x(14);
x15 = x(15);
x16 = x(16);
x17 = x(17);

t1 = (x4^2/(x4^2 + x5^2 + x6^2 + x7^2) - x5^2/(x4^2 + x5^2 + x6^2 + x7^2) - x6^2/(x4^2 + x5^2 + x6^2 + x7^2) + x7^2/(x4^2 + x5^2 + x6^2 + x7^2));

D = real([1;x1;x2;x3;x8;x9;x10;x4;x5;x6;x7;x11;x12;x13;x14;x15;x16;x17;
    (x4*x6)/(x4^2 + x5^2 + x6^2 + x7^2); (x5*x7)/(x4^2 + x5^2 + x6^2 + x7^2); x14^2; x15^2; x16^2; x17^2;
    (x4*x5)/(x4^2 + x5^2 + x6^2 + x7^2); (x6*x7)/(x4^2 + x5^2 + x6^2 + x7^2);
    (x17^2*x5)/(x4^2 + x5^2 + x6^2 + x7^2); (x6*x7)/(x4^2 + x5^2 + x6^2 + x7^2);
    x14^2*t1; x15^2*t1; x16^2*t1; x17^2*t1;
    x5*x11; x6*x12; x7*x13;
    x4*x11; x6*x13; x7*x12;
    x4*x12; x5*x13; x7*x11;
    x4*x13; x5*x12; x6*x11;
    x12*x13;
    x11*x13;
    x11*x12; x14^2; x15^2; x16^2; x17^2;
    x11
    asin(2*x8*x10 - 2*x9*x4); atan2(2*x8*x9 + 2*x10*x4, - 2*x9^2 - 2*x10^2 + 1); x9^2; x10^2; 7072/(7*(2*x9^2 + 2*x10^2 - 1)); 
    (x5*(2*x8*x4 + 2*x9*x10))/abs(- 2*x10^2 + x9*x10*2i - 2*x4^2 + x8*x4*2i + 1);
    (x6*(2*x8*x4 + 2*x9*x10))/abs(- 2*x10^2 + x9*x10*2i - 2*x4^2 + x8*x4*2i + 1);
    (x5*(2*x10^2 + 2*x4^2 - 1))/abs(- 2*x10^2 + x9*x10*2i - 2*x4^2 + x8*x4*2i + 1);
    (x6*(2*x10^2 + 2*x4^2 - 1))/abs(- 2*x10^2 + x9*x10*2i - 2*x4^2 + x8*x4*2i + 1)]);

J = jacobian(D,x);

F = [D,J];
C=[zeros(17,1) eye(17) zeros(17,61-1-17)];
matlabFunction(D,J,C,'file','koopman_learning/uav_D.m');
